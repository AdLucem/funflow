<!DOCTYPE HTML><html>
<head><meta charset="utf-8"><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" rel="stylesheet"><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script></head>
<body><div class="container"><div class="row"><div class="col-sm-12">
<h1>funflow2: Quick reference</h1>
<p>This document presents how to use the API through short examples.</p>
<p>This document uses the following language extensions:</p>
<pre class="haskell"><code>{-# LANGUAGE OverloadedStrings #-}
{-# LANGUAGE Arrows #-}
</code></pre>
<p>All imports are available in the <code>Funflow</code> module:</p>
<pre class="haskell"><code>import Funflow
</code></pre>
<h2>A minimal flow</h2>
<div class="row">
<div class="col-md-1">
In
</div>
<div class="col-md-11">
<pre class="haskell"><code>let
  flow :: Flow String String
  flow = pureFlow $ \input -> "Hello " ++ input ++ " !"
  
  input :: String
  input = "Watson"
in
  runFlow flow input :: IO String
</code></pre>
</div>
</div>
<div class="row">
<div class="col-md-1">
Out
</div>
<div class="col-md-11">
<pre class="text"><code>"Hello Watson !"
</code></pre>
</div>
</div>
<h3>Composing flows</h3>
<div class="row">
<div class="col-md-1">
In
</div>
<div class="col-md-11">
<pre class="haskell"><code>let
  flow1 :: Flow () String
  flow1 = pureFlow $ \input -> "Hello"

  flow2 :: Flow String String
  flow2 = pureFlow $ \input -> input ++ " world"
  
  flow :: Flow () String
  flow = flow1 >>> flow2
in
  runFlow flow () :: IO String
</code></pre>
</div>
</div>
<div class="row">
<div class="col-md-1">
Out
</div>
<div class="col-md-11">
<pre class="text"><code>"Hello world"
</code></pre>
</div>
</div>
<h3>Conditional branching</h3>
<div class="row">
<div class="col-md-1">
In
</div>
<div class="col-md-11">
<pre class="haskell"><code>let
  increment :: Flow Int Int
  increment = pureFlow (+ 1)

  reset :: Flow Int Int
  reset = pureFlow (const 0)

  limitedIncrement :: Flow Int Int
  limitedIncrement = proc n -> do
    if n < 10
      then do increment -< n
      else reset -< n

  flow :: Flow Int Int
  flow = limitedIncrement >>> limitedIncrement >>> limitedIncrement
in
  do
    runFlow flow (9 :: Int) :: IO Int
</code></pre>
</div>
</div>
<div class="row">
<div class="col-md-1">
Out
</div>
<div class="col-md-11">
<pre class="text"><code>1
</code></pre>
</div>
</div>
<h3>Caching a flow</h3>
<div class="row">
<div class="col-md-1">
In
</div>
<div class="col-md-11">
<pre class="haskell"><code>let
  increment :: Flow Int Int
  increment = ioFlow $ \input -> do
    putStrLn "Increment!"
    return $ input + 1

  reset :: Flow Int Int
  reset = pureFlow $ \input -> 0

  cachedIncrement :: Flow Int Int
  cachedIncrement = caching ("increment" :: String) increment

  flow1 :: Flow Int Int
  flow1 = reset >>> increment >>> reset >>> increment

  flow2 :: Flow Int Int
  flow2 = reset >>> cachedIncrement >>> reset >>> cachedIncrement
in
  do
    -- Prints "Increment!" twice to stdout
    runFlow flow1 (0 :: Int) :: IO Int
    -- Prints "Increment!" once to stdout
    runFlow flow2 (0 :: Int) :: IO Int
    return ()
</code></pre>
</div>
</div>
<div class="row">
<div class="col-md-1">
Out
</div>
<div class="col-md-11">
<pre class="text"><code>Increment!
Increment!
Increment!
()
</code></pre>
</div>
</div>
</div></div></div></body></html>
